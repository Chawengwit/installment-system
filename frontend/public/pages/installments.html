<!-- Main Content for Installments Page -->
<div class="container">
    <!-- Header -->
    <header class="page-header">
        <div>
            <h1 class="page-header_title">Existing Installment Plans</h1>
            <p class="page-header_subtitle">Manage and view all active and completed installment plans</p>
        </div>
        <div class="page-header_actions">
            <button class="btn btn-primary" onclick="resetForm()">
                <i class="fas fa-refresh"></i> Reset Form
            </button>
        </div>
    </header>

    <!-- Progress Indicator -->
    <section class="progress-indicator">
        <div class="progress-indicator_container">
            <div class="progress-indicator_step progress-indicator_step-active" data-step="1">
                <div class="progress-indicator_circle">
                    <i class="fas fa-user"></i>
                </div>
                <span class="progress-indicator_label">Customer</span>
            </div>
            <div class="progress-indicator_line"></div>
            <div class="progress-indicator_step" data-step="2">
                <div class="progress-indicator_circle">
                    <i class="fas fa-box"></i>
                </div>
                <span class="progress-indicator_label">Product</span>
            </div>
            <div class="progress-indicator_line"></div>
            <div class="progress-indicator_step" data-step="3">
                <div class="progress-indicator_circle">
                    <i class="fas fa-credit-card"></i>
                </div>
                <span class="progress-indicator_label">Payment</span>
            </div>
            <div class="progress-indicator_line"></div>
            <div class="progress-indicator_step" data-step="4">
                <div class="progress-indicator_circle">
                    <i class="fas fa-calendar"></i>
                </div>
                <span class="progress-indicator_label">Terms</span>
            </div>
            <div class="progress-indicator_line"></div>
            <div class="progress-indicator_step" data-step="5">
                <div class="progress-indicator_circle">
                    <i class="fas fa-check"></i>
                </div>
                <span class="progress-indicator_label">Review</span>
            </div>
        </div>
    </section>

    <!-- Installment Plan Form -->
    <section class="plan-form-section">
        <div class="plan-form-container">
            <form class="plan-form" id="installment-plan-form">
                <!-- Step 1: Customer Selection -->
                <div class="form-step form-step-active" id="step-1">
                    <div class="form-step_header">
                        <h3 class="form-step_title">
                            <span class="form-step_number">1</span>
                            Select Customer
                        </h3>
                        <p class="form-step_description">Choose an existing customer or add a new one</p>
                    </div>
                    
                    <div class="customer-selection">
                        <div class="search-bar">
                            <!-- <label class="form_label">Search Customer</label> -->
                            <div class="search-bar_input-group">
                                <i class="fas fa-search search-bar_icon"></i>
                                <input type="text" class="search-bar_input" 
                                        placeholder="Search by name or phone..." id="customer-search-input">
                            </div>
                        </div>

                        <div class="customer-options">
                            <div class="customer-option" data-customer-id="1">
                                <div class="customer-option_avatar">
                                    <i class="fas fa-user"></i>
                                </div>
                                <div class="customer-option_info">
                                    <h4 class="customer-option_name">John Smith</h4>
                                    <p class="customer-option_details">+1 (555) 123-4567 • 2 active plans</p>
                                </div>
                                <div class="customer-option_status">
                                    <span class="badge badge-success">Good Standing</span>
                                </div>
                            </div>

                            <div class="customer-option" data-customer-id="2">
                                <div class="customer-option_avatar">
                                    <i class="fas fa-user"></i>
                                </div>
                                <div class="customer-option_info">
                                    <h4 class="customer-option_name">Sarah Johnson</h4>
                                    <p class="customer-option_details">+1 (555) 987-6543 • 1 active plan</p>
                                </div>
                                <div class="customer-option_status">
                                    <span class="badge badge-warning">Payment Due</span>
                                </div>
                            </div>

                            <div class="customer-option" data-customer-id="3">
                                <div class="customer-option_avatar">
                                    <i class="fas fa-user"></i>
                                </div>
                                <div class="customer-option_info">
                                    <h4 class="customer-option_name">Mike Davis</h4>
                                    <p class="customer-option_details">+1 (555) 456-7890 • No active plans</p>
                                </div>
                                <div class="customer-option_status">
                                    <span class="badge badge-info">Available</span>
                                </div>
                            </div>
                        </div>

                        <!-- <div class="add-customer-option">
                            <button type="button" class="btn btn-outline btn-full-width" onclick="openModal('add-customer-modal')">
                                <i class="fas fa-plus"></i> Add New Customer
                            </button>
                        </div> -->
                    </div>
                    
                    <div class="form_actions">
                        <button type="button" class="btn btn-primary" onclick="nextStep(2)" disabled id="step-1-next">
                            Next <i class="fas fa-arrow-right"></i>
                        </button>
                    </div>
                </div>

                <!-- Step 2: Product Details -->
                <div class="form-step" id="step-2">
                    <div class="form-step_header">
                        <h3 class="form-step_title">
                            <span class="form-step_number">2</span>
                            Product Details
                        </h3>
                        <p class="form-step_description">Enter the product information and pricing</p>
                    </div>
                    
                    <div class="product-details">
                        <div class="form_row">
                            <div class="form_group">
                                <label class="form_label">Product Category</label>
                                <select class="form_select" id="product-category">
                                    <option value="">Select category...</option>
                                    <option value="electronics">Electronics</option>
                                    <option value="appliances">Home Appliances</option>
                                    <option value="furniture">Furniture</option>
                                    <option value="automotive">Automotive</option>
                                    <option value="other">Other</option>
                                </select>
                            </div>
                            <div class="form_group">
                                <label class="form_label">Product Brand</label>
                                <input type="text" class="form_input" id="product-brand" placeholder="e.g., Apple, Samsung">
                            </div>
                        </div>

                        <div class="form_group">
                            <label class="form_label">Product Name *</label>
                            <input type="text" class="form_input" id="product-name" placeholder="e.g., iPhone 14 Pro Max 256GB" required>
                        </div>
                        
                        <div class="form_row">
                            <div class="form_group">
                                <label class="form_label">Product Price ($) *</label>
                                <div class="input-with-icon">
                                    <i class="fas fa-dollar-sign input-with-icon_icon"></i>
                                    <input type="number" class="form_input" id="product-price" placeholder="0.00" step="0.01" min="0" required>
                                </div>
                            </div>
                            <div class="form_group">
                                <label class="form_label">Down Payment ($)</label>
                                <div class="input-with-icon">
                                    <i class="fas fa-dollar-sign input-with-icon_icon"></i>
                                    <input type="number" class="form_input" id="down-payment" placeholder="0.00" step="0.01" min="0">
                                </div>
                            </div>
                        </div>

                        <div class="form_group">
                            <label class="form_label">Product Description</label>
                            <textarea class="form__textarea" id="product-description" rows="3" placeholder="Additional details about the product..."></textarea>
                        </div>

                        <div class="form_group">
                            <label class="form_label">Product Images</label>
                            <div class="file-upload">
                                <input type="file" class="file-upload_input" id="product-images" multiple accept="image/*">
                                <div class="file-upload_area">
                                    <i class="fas fa-cloud-upload-alt file-upload_icon"></i>
                                    <p class="file-upload_text">Drag & drop images here or click to browse</p>
                                    <p class="file-upload_hint">Support: JPG, PNG, GIF (Max 5MB each)</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="form_actions">
                        <button type="button" class="btn btn-secondary" onclick="prevStep(1)">
                            <i class="fas fa-arrow-left"></i> Previous
                        </button>
                        <button type="button" class="btn btn-primary" onclick="nextStep(3)">
                            Next <i class="fas fa-arrow-right"></i>
                        </button>
                    </div>
                </div>

                <!-- Step 3: Payment Method -->
                <div class="form-step" id="step-3">
                    <div class="form-step_header">
                        <h3 class="form-step_title">
                            <span class="form-step_number">3</span>
                            Payment Method
                        </h3>
                        <p class="form-step_description">Choose how the customer will make payments</p>
                    </div>
                    
                    <div class="payment-methods">
                        <div class="payment-method">
                            <input type="radio" id="cash" name="payment-method" value="cash" class="payment-method_radio">
                            <label for="cash" class="payment-method_label">
                                <div class="payment-method_icon">
                                    <i class="fas fa-money-bill-wave"></i>
                                </div>
                                <div class="payment-method_content">
                                    <span class="payment-method_title">Cash Payment</span>
                                    <span class="payment-method_description">Customer pays in cash at your location</span>
                                </div>
                                <div class="payment-method_check">
                                    <i class="fas fa-check"></i>
                                </div>
                            </label>
                        </div>
                        
                        <div class="payment-method">
                            <input type="radio" id="credit-card" name="payment-method" value="credit-card" class="payment-method_radio">
                            <label for="credit-card" class="payment-method_label">
                                <div class="payment-method_icon">
                                    <i class="fas fa-credit-card"></i>
                                </div>
                                <div class="payment-method_content">
                                    <span class="payment-method_title">Credit Card</span>
                                    <span class="payment-method_description">Automatic charges to customer's credit card</span>
                                </div>
                                <div class="payment-method_check">
                                    <i class="fas fa-check"></i>
                                </div>
                            </label>
                        </div>

                        <div class="payment-method">
                            <input type="radio" id="bank-transfer" name="payment-method" value="bank-transfer" class="payment-method_radio">
                            <label for="bank-transfer" class="payment-method_label">
                                <div class="payment-method_icon">
                                    <i class="fas fa-university"></i>
                                </div>
                                <div class="payment-method_content">
                                    <span class="payment-method_title">Bank Transfer</span>
                                    <span class="payment-method_description">Customer transfers money to your account</span>
                                </div>
                                <div class="payment-method_check">
                                    <i class="fas fa-check"></i>
                                </div>
                            </label>
                        </div>
                    </div>
                    
                    <div class="form_group credit-card-details" id="credit-card-select" style="display: none;">
                        <label class="form_label">Select Credit Card</label>
                        <div class="card-selection">
                            <div class="card-option" data-card-id="1">
                                <div class="card-option_brand">
                                    <i class="fab fa-cc-visa"></i>
                                </div>
                                <div class="card-option_info">
                                    <span class="card-option_name">KBank Visa</span>
                                    <span class="card-option_number">**** **** **** 1234</span>
                                </div>
                                <div class="card-option_limit">
                                    <span class="card-option_available">$15,000 available</span>
                                </div>
                            </div>

                            <div class="card-option" data-card-id="2">
                                <div class="card-option_brand">
                                    <i class="fab fa-cc-mastercard"></i>
                                </div>
                                <div class="card-option_info">
                                    <span class="card-option_name">SCB MasterCard</span>
                                    <span class="card-option_number">**** **** **** 5678</span>
                                </div>
                                <div class="card-option_limit">
                                    <span class="card-option_available">$8,500 available</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="form_actions">
                        <button type="button" class="btn btn-secondary" onclick="prevStep(2)">
                            <i class="fas fa-arrow-left"></i> Previous
                        </button>
                        <button type="button" class="btn btn-primary" onclick="nextStep(4)">
                            Next <i class="fas fa-arrow-right"></i>
                        </button>
                    </div>
                </div>

                <!-- Step 4: Installment Terms -->
                <div class="form-step" id="step-4">
                    <div class="form-step_header">
                        <h3 class="form-step_title">
                            <span class="form-step_number">4</span>
                            Installment Terms
                        </h3>
                        <p class="form-step_description">Configure the payment schedule and terms</p>
                    </div>
                    
                    <div class="installment-terms">
                        <div class="form_row">
                            <div class="form_group">
                                <label class="form_label">Number of Months *</label>
                                <select class="form_select" id="installment-months" required>
                                    <option value="">Select duration...</option>
                                    <option value="3">3 months</option>
                                    <option value="6">6 months</option>
                                    <option value="9">9 months</option>
                                    <option value="12">12 months</option>
                                    <option value="18">18 months</option>
                                    <option value="24">24 months</option>
                                    <option value="36">36 months</option>
                                </select>
                            </div>
                            <div class="form_group">
                                <label class="form_label">Interest Rate (%)</label>
                                <div class="input-with-icon">
                                    <i class="fas fa-percentage input-with-icon_icon"></i>
                                    <input type="number" class="form_input" id="interest-rate" placeholder="15.0" step="0.1" min="0" max="100">
                                </div>
                            </div>
                        </div>

                        <div class="form_row">
                            <div class="form_group">
                                <label class="form_label">Payment Due Date</label>
                                <select class="form_select" id="payment-due-date">
                                    <option value="1">1st of each month</option>
                                    <option value="15">15th of each month</option>
                                    <option value="30">Last day of each month</option>
                                </select>
                            </div>
                            <div class="form_group">
                                <label class="form_label">Late Fee ($)</label>
                                <div class="input-with-icon">
                                    <i class="fas fa-dollar-sign input-with-icon_icon"></i>
                                    <input type="number" class="form_input" id="late-fee" placeholder="25.00" step="0.01" min="0">
                                </div>
                            </div>
                        </div>

                        <!-- Calculation Summary -->
                        <div class="calculation-summary" id="calculation-summary" style="display: none;">
                            <h4 class="calculation-summary_title">
                                <i class="fas fa-calculator"></i>
                                Payment Summary
                            </h4>
                            <div class="calculation-summary_grid">
                                <div class="calculation-summary_item">
                                    <span class="calculation-summary_label">Product Price:</span>
                                    <span class="calculation-summary_value" id="summary-price">$0.00</span>
                                </div>
                                <div class="calculation-summary_item">
                                    <span class="calculation-summary_label">Down Payment:</span>
                                    <span class="calculation-summary_value" id="summary-down-payment">$0.00</span>
                                </div>
                                <div class="calculation-summary_item">
                                    <span class="calculation-summary_label">Financed Amount:</span>
                                    <span class="calculation-summary_value" id="summary-financed">$0.00</span>
                                </div>
                                <div class="calculation-summary_item">
                                    <span class="calculation-summary_label">Interest Rate:</span>
                                    <span class="calculation-summary_value" id="summary-interest-rate">0%</span>
                                </div>
                                <div class="calculation-summary_item">
                                    <span class="calculation-summary_label">Interest Amount:</span>
                                    <span class="calculation-summary_value" id="summary-interest-amount">$0.00</span>
                                </div>
                                <div class="calculation-summary_item calculation-summary_item-total">
                                    <span class="calculation-summary_label">Total Amount:</span>
                                    <span class="calculation-summary_value" id="summary-total">$0.00</span>
                                </div>
                                <div class="calculation-summary_item calculation-summary_item-monthly">
                                    <span class="calculation-summary_label">Monthly Payment:</span>
                                    <span class="calculation-summary_value" id="summary-monthly">$0.00</span>
                                </div>
                                <div class="calculation-summary_item">
                                    <span class="calculation-summary_label">Number of Payments:</span>
                                    <span class="calculation-summary_value" id="summary-payments">0</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="form_actions">
                        <button type="button" class="btn btn-secondary" onclick="prevStep(3)">
                            <i class="fas fa-arrow-left"></i> Previous
                        </button>
                        <button type="button" class="btn btn-primary" onclick="nextStep(5)">
                            Review <i class="fas fa-arrow-right"></i>
                        </button>
                    </div>
                </div>

                <!-- Step 5: Review & Confirm -->
                <div class="form-step" id="step-5">
                    <div class="form-step_header">
                        <h3 class="form-step_title">
                            <span class="form-step_number">5</span>
                            Review & Confirm
                        </h3>
                        <p class="form-step_description">Review all details before creating the installment plan</p>
                    </div>
                    
                    <div class="review-summary">
                        <div class="review-grid">
                            <div class="review-section">
                                <h4 class="review-section_title">
                                    <i class="fas fa-user"></i>
                                    Customer Information
                                </h4>
                                <div class="review-section_content">
                                    <p id="review-customer">John Smith - +1 (555) 123-4567</p>
                                </div>
                            </div>
                            
                            <div class="review-section">
                                <h4 class="review-section_title">
                                    <i class="fas fa-box"></i>
                                    Product Details
                                </h4>
                                <div class="review-section_content">
                                    <p id="review-product">iPhone 14 Pro - $1,200.00</p>
                                </div>
                            </div>
                            
                            <div class="review-section">
                                <h4 class="review-section_title">
                                    <i class="fas fa-credit-card"></i>
                                    Payment Method
                                </h4>
                                <div class="review-section_content">
                                    <p id="review-payment-method">Credit Card - KBank Visa</p>
                                </div>
                            </div>
                            
                            <div class="review-section">
                                <h4 class="review-section_title">
                                    <i class="fas fa-calendar"></i>
                                    Installment Terms
                                </h4>
                                <div class="review-section_content">
                                    <p id="review-terms">12 months - $110.00/month</p>
                                </div>
                            </div>
                        </div>

                        <div class="contract-preview">
                            <h4 class="contract-preview_title">
                                <i class="fas fa-file-contract"></i>
                                Contract Preview
                            </h4>
                            <div class="contract-preview_content">
                                <p>This installment agreement will be automatically generated with all the details above. The customer will receive a copy via email and SMS.</p>
                                <div class="contract-preview_actions">
                                    <button type="button" class="btn btn-outline btn-small">
                                        <i class="fas fa-eye"></i> Preview Contract
                                    </button>
                                    <button type="button" class="btn btn-outline btn-small">
                                        <i class="fas fa-edit"></i> Customize Terms
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="form_actions">
                        <button type="button" class="btn btn-secondary" onclick="prevStep(4)">
                            <i class="fas fa-arrow-left"></i> Previous
                        </button>
                        <button type="submit" class="btn btn-success btn-large">
                            <i class="fas fa-check"></i> Create Installment Plan
                        </button>
                    </div>
                </div>
            </form>
        </div>
    </section>

    <!-- New section for displaying existing installments -->
    <section class="existing-installments-section">
        <!-- <header class="page-header">
            <div>
                <h1 class="page-header_title">Existing Installment Plans</h1>
                <p class="page-header_subtitle">Manage and view all active and completed installment plans</p>
            </div>
        </header> -->

        <section class="search-section">
            <div class="search-bar">
                <div class="search-bar_input-group">
                    <i class="fas fa-search search-bar_icon"></i>
                    <input type="text" class="search-bar_input" 
                            placeholder="Search by customer or product..." id="installment-search">
                </div>
                <div class="form_group">
                    <select class="form_select" id="installment-status-filter">
                        <option value="all">All Statuses</option>
                        <option value="active">Active</option>
                        <option value="pending">Pending</option>
                        <option value="completed">Completed</option>
                    </select>
                </div>
            </div>
        </section>


        <div id="installments-list" class="installments-grid">
            <!-- Installment cards will be loaded here by JavaScript -->
        </div>
    </section>
</div>

<script src="js/installments.js"></script>

